# 浏览器缓存完整笔记（前端总结）

## 一、浏览器缓存目标
- 减少网络请求
- 提升页面加载速度
- 降低服务器压力
- 缓存存在于 HTTP 层与浏览器本地存储层

## 二、浏览器缓存分类
浏览器缓存
- HTTP 缓存
  - 强缓存
  - 协商缓存
- 本地存储缓存
  - Cookie
  - LocalStorage
  - SessionStorage
  - IndexedDB
- Service Worker Cache（PWA）
- 内存缓存（Memory Cache）
- 磁盘缓存（Disk Cache）

## 三、HTTP 缓存

### 3.1 强缓存（Strong Cache）
- 特点：
  - 浏览器不发请求
  - Network 面板显示 `200 (from memory/disk cache)`
- 控制字段：
  - `Cache-Control: max-age, public, private, no-cache, no-store, immutable`
  - `Expires`（HTTP/1.0，已过时，受客户端时间影响）
- 优先级：Cache-Control > Expires

### 3.2 协商缓存（Conditional Cache）
- 特点：
  - 浏览器会发请求
  - 服务器判断资源是否修改
  - 未修改返回 `304 Not Modified`
- 控制字段：
  - `ETag` / `If-None-Match`（推荐，精确到内容）
  - `Last-Modified` / `If-Modified-Since`（精度秒，可能误判）

### 3.3 强缓存 vs 协商缓存
| 维度 | 强缓存 | 协商缓存 |
|---|---|---|
| 是否发请求 | 否 | 是 |
| 性能 | 高 | 中 |
| 是否校验服务器 | 否 | 是 |
| 状态码 | 200 | 304 |

## 四、浏览器本地存储

| 类型 | 容量 | 生命周期 | 跨标签 | 随请求 | 用途 |
|---|---|---|---|---|---|
| Cookie | ~4KB | 可设置 | 是 | 是 | 登录态、token |
| LocalStorage | ~5MB | 永久 | 是 | 否 | 静态数据缓存 |
| SessionStorage | ~5MB | 当前标签页 | 否 | 否 | 临时状态 |
| IndexedDB | MB~GB | 永久 | 是 | 否 | 大数据、离线缓存 |

## 五、Service Worker Cache（PWA）
- 运行在独立线程
- 可拦截所有网络请求，完全可控
- 缓存策略：
  - Cache First：优先缓存
  - Network First：优先网络
  - Stale While Revalidate：先缓存，后台更新

## 六、内存缓存与磁盘缓存
- Memory Cache：存在内存，页面关闭即失效，访问速度最快
- Disk Cache：存在磁盘，可长期存储，受 HTTP 缓存策略控制

## 七、缓存优先级
